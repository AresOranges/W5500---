# W5500以太网网络模块
淘宝链接：  https://m.tb.cn/h.fPzf7fQ?tk=vZWs2cICR8c  
相关博客：   
1. https://blog.csdn.net/qq_45659777/article/details/121952778?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0.pc_relevant_default&spm=1001.2101.3001.4242.1&utm_relevant_index=3  
2. https://blog.csdn.net/weixin_46129506/article/details/122149700  
3. https://zhuanlan.zhihu.com/p/357002381       

# SPI通信  
同步 全双工通信  
（同步：发送方发出数据后，等待收方发回响应后，再发下一个数据包  
    异步：发送方发出数据后，接着发送下一个数据包，不等待收方发回响应）  

SPI总共有4根线：  
SCLK (Serial Clock) 串行时钟 传输时钟信号的信号线。    
CS (SS) 片选信号（从设备选择） 用于选择从设备的信号线，低电平有效。  
MOSI (Master Out Slave In) 主设备出，从设备入  
MISO (Master In Slave Out) 主设备入，从设备出。  

上升沿发送，下降沿接收，高位先发送。  

CPOL：时钟极性选择，为0时SPI总线空闲为低电平，为1时SPI总线空闲为高电平  
CPHA：时钟相位选择，为0时在时钟第一个跳变沿采样，为1时在时钟第二个跳变沿采样  

# 客户端模式  
必须设置的网络参数：  
unsigned char Gateway_IP[4]; //网关IP地址，4个字节  
unsigned char Sub_Mask[4]; //子网掩码，4个字节  
unsigned char Phy_Addr[6]; //物理地址(MAC)，6个字节，第一个字节必须为偶数   
unsigned char IP_Addr[4]; //本机IP地址，4个字节  
unsigned char S0_Port[2]; //端口0的端口号，2个字节  
unsigned char S0_DIP[4]; //端口0目的IP地址，4个字节  
unsigned char S0_DPort[2]; //端口0目的端口号，2 个字节     

例程网络参数：   
//网关：192.168.1.1    
//掩码:	255.255.255.0     
//物理地址：0C 29 AB 7C 00 01     
//本机IP地址:192.168.1.199    
//端口0的端口号：5000     
//端口0的目的IP地址：192.168.1.190       
//端口0的目的端口号：6000   

（PS：KEIL中Edit-Configuration-Encode in ANSI是默认状态，切换成Chinese GB2312(Simplified)就可以复制粘贴了，而且目前测试编译没影响）　  
（PS：word英文字符和数字间距突然变大：中文输入变为全角状态了，shift+空格变换下全半角状态就好了）         

插曲：   
IP地址  
IP是32位二进制数据，通常以4个十进制表示，用"."分隔。IP有唯一性（指的是公网地址），每台机器的IP在全世界都是唯一的。   
IP地址=网络地址+主机地址   
一般内网的 IP 地址是以 192.168 开头，这样很容易区分公网和内网的 IP 地址。     
设置1号机的 IP 地址为 192.168.0.1，子网掩码为 255.255.255.0，2号机的IP地址为 192.168.0.200，子网掩码为 255.255.255.0，这两台计算机就能正常通讯。    
为什么呢？   
这样计算网络地址：将 IP 地址和子网掩码都换算成二进制，然后进行与运算，结果就是网络地址。  
与运算如下所示，上下对齐，1位1位的算，1与1=1，其余组合都为0。   
        1..0..1..0  
        1..1..0..0   
 结果   1..0..0..0   
因此例子中的网络地址就是202.99.160.0  

子网掩码  
子网掩码是用来判断任意两台计算机的 IP 地址是否属于同一子网络的根据。  
判断两台计算机是否处于同一个子网络上：求出网络地址是否相同。即两台计算机各自的 IP 地址与子网掩码进行 and 运算后，得出的结果是否相同。   

网关  
网关实质上是一个网络通向其他网络的IP地址。  
比如有网络 A 和网络 B，  
网络 A 的 IP 地址范围为 192.168.1.1 ~ 192.168.1.254，子网掩码为 255.255.255.0     
网络 B 的 IP 地址范围为 192.168.2.1 ~ 192.168.2.254，子网掩码为 255.255.255.0     
在没有路由器的情况下，两个网络之间是不能进行 TCP/IP 通信的，即使是两个网络连接在同一台交换机(或集线器)上，TCP/IP 协议也会根据子网掩码   (255.255.255.0) 判定两个网络中的主机是否处在不同的网络里。而要实现这两个网络之间的通信，则必须通过网关。  
如果网络 A 中的主机发现数据包的目的主机不在本地网络中，就把数据包转发给它自己的网关，再由网关转发给网络 B 的网关，网络 B 的网关再转发给网络 B 的某个主机。 
所以说，只有设置好网关的 IP 地址，TCP/IP 协议才能实现不同网络之间的相互通信。那么这个 IP 地址是哪台机器的 IP 地址呢？网关的 IP 地址是具有路由功能的设备的 IP 地址，具有路由功能的设备最典型的就是路由器，路由器接口使用的IP地址就是网关的地址，它可以是本网段中任何一个地址，不过通常使用该网段的第一个可用的地址或最后一个可用的地址，这是为了尽可能避免和本网段中的主机地址冲突。    

DNS服务器
DNS：域名系统(Domain Name System)。在 Internet 上，域名与 IP 地址之间是一 一对应的，域名虽然便于人们记忆，但机器之间只能互相识别 IP 地址，它们之间的转换工作称为域名解析，域名解析需要由专门的域名解析服务器来完成，DNS 服务器就是进行域名解析的服务器。  
如果没有这东西，你必须输入网站的 IP 地址，有了DNS 服务器，你就可以直接输入网址。  

插曲OVER  
